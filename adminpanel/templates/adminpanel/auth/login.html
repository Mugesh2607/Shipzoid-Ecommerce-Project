{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Shipzoid</title>
    <meta name="csrf-token" content="{{ csrf_token }}">
    <link rel="icon" type="image/png" href="{% static 'adminpanel/images/brand/shipzoid.jpeg' %}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="{% static 'adminpanel/js/jquery-3.6.4.min.js' %}"></script>
    <!-- SweetAlert2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.12.1/dist/sweetalert2.min.css" rel="stylesheet">

    <!-- Animate.css for animations -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">

    
    <style>
        /* Keyframe for smooth fade & slide animation */
        @keyframes slideFade {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-slideFade {
            animation: slideFade 0.8s ease-in-out forwards;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center">
    <div class="w-full max-w-5xl bg-white rounded-2xl shadow-lg overflow-hidden flex flex-col md:flex-row animate-slideFade">
        
        <!-- Left Side Image -->
        <div class="hidden md:block w-1/2 bg-cover bg-center" 
               style="background-image: url('{% static "adminpanel/images/brand/shipzoid.jpeg" %}');">
        </div>

        <!-- Right Side Form -->
        <div class="w-full md:w-1/2 p-10 flex flex-col justify-center">
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Welcome Back ðŸ‘‹</h2>
            <p class="text-gray-500 mb-6">Login to your account to continue</p>

            <form id="loginForm" method="post" class="space-y-5">
                {% csrf_token %}
                <div>
                    <label class="block text-gray-600">Email</label>
                    <input type="email" placeholder="you@example.com"  name="email"
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 transition" />
                    <p id="email_error" class="text-red-500 text-sm"></p>
                </div>
                <div class="relative">
                    <label class="block text-gray-600">Password</label>
                    <input type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"  name="password" id="password"
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-teal-500 transition" />
                    <!-- Eye Icon -->
                    <button type="button" onclick="togglePassword()" 
                            class="absolute right-3 top-9 text-slate-500 hover:text-slate-700">
                        <i id="toggleIcon" class="fas fa-eye"></i>
                    </button>
                    <p id="password_error" class="text-red-500 text-sm"></p>
                </div>

                <div class="flex justify-between items-center text-sm">
                    <label class="flex items-center gap-2">
                        <input type="checkbox" class="form-checkbox text-teal-500" name="rememberme" /> Remember me
                    </label>
                    <a href="#" class="text-teal-500 hover:underline">Forgot password?</a>
                </div>

                <button type="submit"
                        class="w-full bg-teal-500 text-white py-3 rounded-lg hover:bg-teal-600 transition transform hover:scale-[1.02] shadow-lg">
                    Login
                </button>
            </form>

            <p class="mt-6 text-sm text-gray-600">
                Donâ€™t have an account? 
                <a href="{% url 'adminpanel:signup' %}" class="text-teal-500 hover:underline">Sign Up</a>
            </p>
        </div>
    </div>


    <script>
        $("#loginForm").submit(function(e) {
            e.preventDefault();
            $("#email_error").text("");
            $("#password_error").text("");

            $.ajax({
                url: "{% url 'adminpanel:authenticate' %}",
                method: "POST",
                data: $(this).serialize(),
                success: function(response) {
                    if (response.success) {
                        window.location.href = response.redirect_url;
                    }
                },
                error: function(xhr) {
                    let errors = JSON.parse(xhr.responseText).errors;
                    if (errors.email) {
                        $("#email_error").text(errors.email[0].message);
                    }
                    if (errors.password) {
                        $("#password_error").text(errors.password[0].message);
                    }
                    if (errors.__all__) {
                        $("#password_error").text(errors.__all__[0].message);
                    }
                }
            });
        });

        function togglePassword() {
            const passwordInput = document.getElementById("password");
            const toggleIcon = document.getElementById("toggleIcon");
            
            if (passwordInput.type === "password") {
                passwordInput.type = "text";
                toggleIcon.classList.remove("fa-eye");
                toggleIcon.classList.add("fa-eye-slash");
            } else {
                passwordInput.type = "password";
                toggleIcon.classList.remove("fa-eye-slash");
                toggleIcon.classList.add("fa-eye");
            }
        }
    </script>

    <script>
    {% if messages %}
        {% for message in messages %}
            toastr.options = {
                "closeButton": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "timeOut": "3000"
            };

            {% if message.tags == "error" %}
                toastr.error("{{ message|escapejs }}");
            {% elif message.tags == "warning" %}
                toastr.warning("{{ message|escapejs }}");
            {% elif message.tags == "success" %}
                toastr.success("{{ message|escapejs }}");
            {% else %}
                toastr.info("{{ message|escapejs }}");
            {% endif %}
        {% endfor %}
    {% endif %}
</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        {% if messages %}
            {% for message in messages %}
                Swal.fire({
                    toast: true,
                    position: 'top-end',
                    icon: '{% if "error" in message.tags %}error{% elif "warning" in message.tags %}warning{% elif "success" in message.tags %}success{% else %}info{% endif %}',
                    title: "{{ message|escapejs }}",
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    background: '#fff',
                    color: '#333',
                    showClass: {
                        popup: 'animate__animated animate__fadeInDown'
                    },
                    hideClass: {
                        popup: 'animate__animated animate__fadeOutUp'
                    }
                });
            {% endfor %}
        {% endif %}
    });
</script>



<!-- SweetAlert2 JS -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.12.1/dist/sweetalert2.all.min.js"></script>

</body>
</html>
